{% extends 'layout.html' %}

{% load tags %}

{% block title %}
    Depots by organization
{% endblock %}

{% block content %}
    <div class="page-header">
        <h1>Depots by organization</h1>
    </div>

    {% for organization in organization_depots %}
        <h2>
            {{ organization.model.name }}
            {% if organization.managed_by_user %}
                <a href="{% url 'admin:depot_organization_change' organization.model.id %}"
                        class="btn btn-default" target="_blank">
                    Manage
                </a>
            {% endif %}
        </h2>

        <div class="alert alert-info">
            This organization is managed by {% concat_with_and organization.model.managers.all|full_names empty='no one apparently' %}.
        </div>

        <div class="row">
            {% for depot in organization.depots %}
                <div class="col-md-4 col-sm-6">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <a href="{% url 'depot:detail' depot.id %}">
                                <h3 class="panel-title">
                                    {{ depot.name }}

                                    <span class="badge">{{ depot.public_items.count }} items</span>

                                    {% if not depot.active %}
                                        <span class="label label-default">inactive</td>
                                    {% endif %}
                                </h3>
                            </a>
                        </div>
                        <div class="panel-body">
                            This depot contains {{ depot.public_items.count }} items.
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% empty %}
        <div class="alert alert-danger" role="alert">
            No depots available :(
        </div>
    {% endfor %}
{% endblock %}
